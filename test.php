<?php

include("classes/connect.php");
include("classes/fingger.php");

// Bikin objek checker
$checker = new PacketChecker();

$packet2 = pack("C*", 0x05, 0x07, 0x5D, 0x16, 0x00, 0x01, 0x20, 0x01, 0x91, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x85);
$packet3 = pack("C*", 0x08, 0x03, 0x5D, 0x16, 0x00, 0x01, 0x20, 0x01, 0x91, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x85, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xCF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xAA, 0xEA, 0xAA, 0xAA, 0xAA, 0xAA, 0x6A, 0x95, 0xA6, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x55, 0x44, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00);

// Cek data
$result = $checker->check($packet2, $packet3);

if ($result) {
    echo "âœ… Data cocok:<br>";
    echo "UserID: " . $result['userid'] . "<br>";
    echo "Nama: " . $result['nama'] . "<br>";
    echo "Packet2 HEX: " . $result['packet2_hex'] . "<br>";
    echo "Packet3 HEX: " . $result['packet3_hex'] . "<br>";
} else {
    echo $checker->getError();
}
